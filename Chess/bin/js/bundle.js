var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
				value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /**This class is automatically generated by LayaAirIDE, please do not make any modifications. */


var _ChessScene = require("./script/ChessScene");

var _ChessScene2 = _interopRequireDefault(_ChessScene);

var _BoardSet = require("./script/component/BoardSet");

var _BoardSet2 = _interopRequireDefault(_BoardSet);

var _randomTouz = require("./script/component/randomTouz");

var _randomTouz2 = _interopRequireDefault(_randomTouz);

var _GridSet = require("./script/component/GridSet");

var _GridSet2 = _interopRequireDefault(_GridSet);

var _standMove = require("./script/component/standMove");

var _standMove2 = _interopRequireDefault(_standMove);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GameConfig = function () {
				function GameConfig() {
								_classCallCheck(this, GameConfig);
				}

				_createClass(GameConfig, null, [{
								key: "init",
								value: function init() {
												//注册Script或者Runtime引用
												var reg = Laya.ClassUtils.regClass;
												reg("script/ChessScene.js", _ChessScene2.default);
												reg("script/component/BoardSet.js", _BoardSet2.default);
												reg("script/component/randomTouz.js", _randomTouz2.default);
												reg("script/component/GridSet.js", _GridSet2.default);
												reg("script/component/standMove.js", _standMove2.default);
								}
				}]);

				return GameConfig;
}();

exports.default = GameConfig;

GameConfig.width = 1280;
GameConfig.height = 640;
GameConfig.scaleMode = "showall";
GameConfig.screenMode = "horizontal";
GameConfig.alignV = "top";
GameConfig.alignH = "left";
GameConfig.startScene = "main.scene";
GameConfig.sceneRoot = "";
GameConfig.debug = true;
GameConfig.stat = false;
GameConfig.physicsDebug = false;
GameConfig.exportSceneToJson = true;

GameConfig.init();

},{"./script/ChessScene":3,"./script/component/BoardSet":6,"./script/component/GridSet":7,"./script/component/randomTouz":8,"./script/component/standMove":9}],2:[function(require,module,exports){
"use strict";

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameConfig = require("./GameConfig");

var _GameConfig2 = _interopRequireDefault(_GameConfig);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var Main = function () {
	function Main() {
		_classCallCheck(this, Main);

		//根据IDE设置初始化引擎		
		if (window["Laya3D"]) Laya3D.init(_GameConfig2.default.width, _GameConfig2.default.height);else Laya.init(_GameConfig2.default.width, _GameConfig2.default.height, Laya["WebGL"]);
		Laya["Physics"] && Laya["Physics"].enable();
		Laya["DebugPanel"] && Laya["DebugPanel"].enable();
		Laya.stage.scaleMode = _GameConfig2.default.scaleMode;
		Laya.stage.screenMode = _GameConfig2.default.screenMode;
		Laya.stage.alignV = _GameConfig2.default.alignV;
		Laya.stage.alignH = _GameConfig2.default.alignH;
		//兼容微信不支持加载scene后缀场景
		Laya.URL.exportSceneToJson = _GameConfig2.default.exportSceneToJson;

		//打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
		if (_GameConfig2.default.debug || Laya.Utils.getQueryString("debug") == "true") Laya.enableDebugPanel();
		if (_GameConfig2.default.physicsDebug && Laya["PhysicsDebugDraw"]) Laya["PhysicsDebugDraw"].enable();
		if (_GameConfig2.default.stat) Laya.Stat.show();
		Laya.alertGlobalError = true;

		//激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
		Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
	}

	_createClass(Main, [{
		key: "onVersionLoaded",
		value: function onVersionLoaded() {
			//激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
			Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
		}
	}, {
		key: "onConfigLoaded",
		value: function onConfigLoaded() {
			//加载IDE指定的场景
			_GameConfig2.default.startScene && Laya.Scene.open(_GameConfig2.default.startScene);
		}
	}]);

	return Main;
}();
//激活启动类


new Main();

},{"./GameConfig":1}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _GameData = require("./GameData");

var _GameData2 = _interopRequireDefault(_GameData);

var _BoardSet = require("./component/BoardSet");

var _BoardSet2 = _interopRequireDefault(_BoardSet);

var _GridSet = require("./component/GridSet");

var _GridSet2 = _interopRequireDefault(_GridSet);

var _randomTouz = require("./component/randomTouz");

var _randomTouz2 = _interopRequireDefault(_randomTouz);

var _standMove = require("./component/standMove");

var _standMove2 = _interopRequireDefault(_standMove);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var ChessScene = function (_Laya$Scene) {
    _inherits(ChessScene, _Laya$Scene);

    function ChessScene() {
        _classCallCheck(this, ChessScene);

        var _this2 = _possibleConstructorReturn(this, (ChessScene.__proto__ || Object.getPrototypeOf(ChessScene)).call(this));

        _this2.gmd = _GameData2.default.GetInstance();
        return _this2;
    }

    _createClass(ChessScene, [{
        key: "onEnable",
        value: function onEnable() {
            this.initAllPreSet();

            this.initSceneUI();
            this.initAllGrids();
            this.initAllChesses();

            this.initDebug();
        }
    }, {
        key: "initAllPreSet",
        value: function initAllPreSet() {
            this.preSet = this.Borad.getComponent(_BoardSet2.default);
        }
    }, {
        key: "initSceneUI",
        value: function initSceneUI() {}
    }, {
        key: "initAllGrids",
        value: function initAllGrids() {
            this.grids = [];

            var data = this.gmd.boradDatas;
            var count = data.count;
            var preset = this.preSet.gridPre;

            for (var i = 0; i < count; i++) {
                var gridObj = preset.create();
                var grid = {
                    com: gridObj,
                    ID: i,
                    data: data.random ? this.getRandomGrid(i) : data[i]
                };
                this.grids.push(grid);
                this.BoardContent.addChild(gridObj);

                gridObj.getComponent(_GridSet2.default).SetGridData(grid.data);
            }

            this.refreshContentScroll();
        }
    }, {
        key: "initAllChesses",
        value: function initAllChesses() {
            this.chesses = [];
            var preset = this.preSet.chessPre;

            for (var i = 0; i < this.gmd.gameConfig.maxPlayer; i++) {
                var chessObj = preset.create();
                var moveCom = chessObj.getComponent(_standMove2.default);

                var _this = this;
                moveCom.SetStandIndex(i);
                moveCom.SetCalcPos(function (index, id) {
                    var pos = _this.CalcPos(index);
                    var offPos = [50 + 50 * (id % 2), 60 + Math.floor(id / 2) * 80];
                    return [pos[0] + offPos[0], pos[1] + offPos[1]];
                });
                this.chesses.push({
                    id: i,
                    com: chessObj,
                    posIndex: 0,
                    score: 0,
                    move: moveCom,
                    isAI: i > 0
                });

                chessObj.zOrder = 20;

                this.BoardContent.addChild(chessObj);
            }

            this.curChess = 0;
            this.RefreshScore();

            this.getCurPlayer().move.GetCurrent();
        }
    }, {
        key: "getCurPlayer",
        value: function getCurPlayer() {
            return this.chesses[this.curChess];
        }
    }, {
        key: "getRandomGrid",
        value: function getRandomGrid(_index) {

            var moveFlag = Math.floor(Math.random() * 8);
            var scoreGet = 0;
            var desc = '';

            if (_index == 0) {
                moveFlag = 0;
                desc = '起点';
            } else if (_index == this.gmd.boradDatas.count - 1) {
                moveFlag = 0;
                desc = '终点';
            } else {
                if (moveFlag < 6) {
                    scoreGet = Math.floor(Math.random() * 6) * 500 - 1000;
                    if (scoreGet >= 0) scoreGet += 500;else scoreGet /= 2;
                    moveFlag = 0;
                    desc += "Score:" + scoreGet;
                } else {
                    moveFlag -= 5;
                    desc += moveFlag == 1 ? '前进' : '后退';
                }
            }

            var randRange = function randRange(max) {
                return Math.floor(Math.random() * max);
            };

            return {
                color: [randRange(255), randRange(255), randRange(255)],
                title: "Index" + _index,
                moveTag: moveFlag,
                scoreGet: scoreGet,
                func: function func(player) {},
                index: _index,
                desc: desc,
                pos: this.CalcPos(_index)
            };
        }
    }, {
        key: "CalcPos",
        value: function CalcPos(_index) {
            var width = this.gmd.boradDatas.width;
            var xOff = (width + 1) * 2;
            var yOff = width + 1;

            var y = Math.floor(_index / yOff) * 2 * 202 + 10;
            if ((_index + 1) % yOff == 0) {
                y += 202;
            }

            var x = 0;
            var xdir = _index % xOff;
            if (xdir < width) {
                x = xdir * 152 + 10;
            } else if (xdir == width) {
                x = xdir * 152 + 10 - 152;
            } else if (xdir > width && xdir < xOff - 1) {
                x = (2 * width - xdir) * 152 + 10;
            } else if (xdir == xOff - 1) {
                x = 10;
            }

            return [x, y];
        }
    }, {
        key: "refreshContentScroll",
        value: function refreshContentScroll() {
            var width = this.gmd.boradDatas.width;
            var count = this.gmd.boradDatas.count;
            var yOff = width + 1;

            this.BoardContent.width = width * 152 + 30;
            this.BoardContent.height = 630;
        }
    }, {
        key: "initDebug",
        value: function initDebug() {
            var _this3 = this;

            this.test.on(Laya.Event.CLICK, this, function () {
                _this3.test.visible = false;
                _this3.SightLockOn(_this3.getCurPlayer());
                _this3.RollDiceToMoveOn(true);
            });
        }
    }, {
        key: "RollDiceToMoveOn",
        value: function RollDiceToMoveOn(dir) {
            var _this4 = this;

            this.touz.getComponent(_randomTouz2.default).Action(this, function (score) {
                var curIndex = _this4.getCurPlayer().posIndex;

                var afIndex = curIndex;

                if (dir) {
                    afIndex = Math.min(_this4.gmd.boradDatas.count - 1, score + curIndex);
                } else {
                    afIndex = Math.max(0, curIndex - score);
                }

                var _this = _this4;
                _this4.getCurPlayer().move.MoveToPos(curIndex, afIndex, function (index, pass) {
                    _this.getCurPlayer().posIndex = index;
                    if (pass) {
                        _this.TriggerAtGrid(_this4.getCurPlayer(), index);
                    }
                    _this.SightLockOn(_this.getCurPlayer());
                });
            });
        }
    }, {
        key: "TriggerAtGrid",
        value: function TriggerAtGrid(player, _index) {
            var _this5 = this;

            var grid = this.grids[_index];

            var data = grid.data;

            if (data.scoreGet != 0) {
                player.score += data.scoreGet;
            } else if (data.moveTag == 1) {
                Laya.timer.once(500, this, function () {
                    _this5.RollDiceToMoveOn(true);
                });
                return;
            } else if (data.moveTag == 2) {
                Laya.timer.once(500, this, function () {
                    _this5.RollDiceToMoveOn(false);
                });
                return;
            }

            this.RefreshScore();
            this.NextPlayer();
        }
    }, {
        key: "RefreshScore",
        value: function RefreshScore() {
            this.Score.text = "" + this.getCurPlayer().score;
        }
    }, {
        key: "NextPlayer",
        value: function NextPlayer() {
            var _this6 = this;

            this.getCurPlayer().move.LoseCurrent();

            this.curChess++;
            this.curChess %= this.gmd.gameConfig.maxPlayer;

            this.getCurPlayer().move.GetCurrent();

            if (this.getCurPlayer().isAI) {
                Laya.timer.once(800, this, function () {
                    _this6.SightLockOn(_this6.getCurPlayer());
                    _this6.RollDiceToMoveOn(true);
                });
            } else {
                this.test.visible = true;
            }
        }
    }, {
        key: "SightLockOn",
        value: function SightLockOn(_player) {
            var _index = _player.posIndex;
            var yoff = this.CalcPos(_index)[1];
            var curScroll = this.BoardContent.vScrollBar.value;

            if (yoff < curScroll || yoff > curScroll + this.BoardContent.height - 150) this.BoardContent.vScrollBar.value = yoff - 10 - this.BoardContent.height / 2 + 100;
        }
    }]);

    return ChessScene;
}(Laya.Scene);

exports.default = ChessScene;

},{"./GameData":4,"./component/BoardSet":6,"./component/GridSet":7,"./component/randomTouz":8,"./component/standMove":9}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GameData = function () {
    _createClass(GameData, null, [{
        key: "GetInstance",
        value: function GetInstance() {
            if (!GameData.instance) GameData.instance = new GameData();
            return GameData.instance;
        }
    }]);

    function GameData() {
        _classCallCheck(this, GameData);

        this.gameConfig = {
            maxPlayer: 4,
            AIFix: true,
            AICount: 3,
            curPlayer: 1
        };

        this.boradDatas = {
            count: 100,
            width: 6,
            random: true,
            datas: []
        };

        GameData.instance = this;
    }

    return GameData;
}();

exports.default = GameData;

},{}],5:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});
function load_map(obj, root, nameMap) {
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
        for (var _iterator = nameMap[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            var name = _step.value;

            obj[name] = root.getChildByName(name);
        }
    } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
    } finally {
        try {
            if (!_iteratorNormalCompletion && _iterator.return) {
                _iterator.return();
            }
        } finally {
            if (_didIteratorError) {
                throw _iteratorError;
            }
        }
    }
}

exports.default = load_map;

},{}],6:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var BoardSet = function (_Laya$Script) {
    _inherits(BoardSet, _Laya$Script);

    /** @prop {name:gridPre,tips:"棋盘预制",type:Prefab} */
    /** @prop {name:chessPre,tips:"棋子预制",type:Prefab} */

    function BoardSet() {
        _classCallCheck(this, BoardSet);

        return _possibleConstructorReturn(this, (BoardSet.__proto__ || Object.getPrototypeOf(BoardSet)).call(this));
    }

    return BoardSet;
}(Laya.Script);

exports.default = BoardSet;

},{}],7:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _nameMap = require("../addon/nameMap");

var _nameMap2 = _interopRequireDefault(_nameMap);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var GridSet = function (_Laya$Script) {
    _inherits(GridSet, _Laya$Script);

    function GridSet() {
        _classCallCheck(this, GridSet);

        var _this = _possibleConstructorReturn(this, (GridSet.__proto__ || Object.getPrototypeOf(GridSet)).call(this));

        _this.showing = false;
        _this.GrdiData = {
            color: [255, 255, 255],
            title: "Hello",
            func: function func(player) {},
            moveTag: 0,
            scoreGet: 0,
            desc: "",
            index: 0,
            pos: [0, 0]
        };
        _this.colorDirty = false;
        return _this;
    }

    _createClass(GridSet, [{
        key: "onEnable",
        value: function onEnable() {
            (0, _nameMap2.default)(this, this.owner.content, ["title", "bg", "desc"]);
            this.refreshGrid();
            this.showing = true;
        }
    }, {
        key: "onUpdate",
        value: function onUpdate() {
            if (this.colorDirty && this.bg.filters) {
                this.colorFilter = this.bg.filters[0];
                var color = this.GrdiData.color;
                this.colorFilter.color(color[0], color[1], color[2]);
            }
        }
    }, {
        key: "SetGridData",
        value: function SetGridData(_data) {
            this.GrdiData = _data;
            if (this.showing) {
                this.refreshGrid();
            }
            this.colorDirty = true;
        }
    }, {
        key: "refreshGrid",
        value: function refreshGrid() {
            this.owner.pos(this.GrdiData.pos[0], this.GrdiData.pos[1]);
            this.title.text = this.GrdiData.title;
            this.desc.text = this.GrdiData.desc;
        }
    }]);

    return GridSet;
}(Laya.Script);

exports.default = GridSet;

},{"../addon/nameMap":5}],8:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var RandomTouzi = function (_Laya$Script) {
    _inherits(RandomTouzi, _Laya$Script);

    /** @prop {name:rollGap,tips:"骰子旋转周期",type:Int} */
    /** @prop {name:rollTime,tips:"骰子旋转时间",type:Int} */

    function RandomTouzi() {
        _classCallCheck(this, RandomTouzi);

        return _possibleConstructorReturn(this, (RandomTouzi.__proto__ || Object.getPrototypeOf(RandomTouzi)).call(this));
    }

    _createClass(RandomTouzi, [{
        key: "onEnable",
        value: function onEnable() {
            var _this2 = this;

            this.rolling = false;
            this.number = 1;

            this.owner.texture = "image/" + this.number + ".png";

            Laya.timer.frameLoop(this.rollGap, this, function () {
                if (_this2.rolling) {
                    _this2.RandomOnce();
                }
            });
        }
    }, {
        key: "Action",
        value: function Action(caller, resFunc) {
            var _this3 = this;

            this.rolling = true;
            Laya.timer.once(this.rollTime, this, function () {
                _this3.rolling = false;
                resFunc.call(caller, _this3.number);
            });
        }
    }, {
        key: "RandomOnce",
        value: function RandomOnce() {
            this.number = this.number + Math.floor(Math.random() * 5);
            this.number %= 6;
            this.number += 1;

            this.owner.texture = "image/" + this.number + ".png";
        }
    }]);

    return RandomTouzi;
}(Laya.Script);

exports.default = RandomTouzi;

},{}],9:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var StandMove = function (_Laya$Script) {
    _inherits(StandMove, _Laya$Script);

    /** @prop {name:moveSpeed,tips:"移动速度",type:Int} */

    function StandMove() {
        _classCallCheck(this, StandMove);

        var _this = _possibleConstructorReturn(this, (StandMove.__proto__ || Object.getPrototypeOf(StandMove)).call(this));

        _this.calcPos = function (_index, _id) {
            return [0, 0];
        };
        _this.triggerFunc = function (index, pass) {};
        _this.stPos = 0;
        _this.edPos = 0;
        _this.targetPos = [0, 0];
        _this.movePace = [0, 0];
        _this.dir = 1;

        _this.index = 0;

        _this.current = false;
        _this.br = 0;
        return _this;
    }

    _createClass(StandMove, [{
        key: "onEnable",
        value: function onEnable() {
            var _this2 = this;

            Laya.timer.frameLoop(1, this, function () {
                if (_this2.movePace[0] != 0 || _this2.movePace[1] != 0) _this2.owner.pos(_this2.owner.x + _this2.movePace[0], _this2.owner.y + _this2.movePace[1]);
            });

            Laya.timer.loop(100, this, function () {
                if (_this2.current) {
                    if (_this2.owner.filters) {
                        var filter = _this2.owner.filters[0];
                        var pbr = Math.sin(_this2.br) * 100;
                        _this2.br += 0.4;
                        var cbr = Math.sin(_this2.br) * 100;
                        filter.adjustBrightness(cbr - pbr);
                    }
                }
            });
        }
    }, {
        key: "SetCalcPos",
        value: function SetCalcPos(func) {
            this.calcPos = func;
            this.EnsurePlace();
        }
    }, {
        key: "SetStandIndex",
        value: function SetStandIndex(id) {
            this.index = id;
            this.owner.texture = "image/t" + id + ".png";
        }
    }, {
        key: "MoveToPos",
        value: function MoveToPos(stindex, edindex, reFunc) {
            this.stPos = stindex;
            this.edPos = edindex;
            this.triggerFunc = reFunc;

            this.dir = edindex > stindex ? 1 : -1;

            this.EnsurePlace();

            this.PaceOn();
        }
    }, {
        key: "PaceOn",
        value: function PaceOn() {
            var _this3 = this;

            var curPos = [this.owner.x, this.owner.y];
            if (this.edPos != this.stPos) {
                var targetPos = this.calcPos(this.stPos + this.dir, this.index);
                this.targetPos = targetPos;

                var xoff = this.targetPos[0] - curPos[0];
                var yoff = this.targetPos[1] - curPos[1];

                var distance = Math.sqrt(xoff * xoff + yoff * yoff);
                var timeCost = distance / this.moveSpeed;

                this.movePace = [this.moveSpeed * xoff / distance, this.moveSpeed * yoff / distance];

                Laya.timer.frameOnce(timeCost, this, function () {
                    _this3.stPos += _this3.dir;
                    _this3.EnsurePlace();
                    _this3.triggerFunc(_this3.stPos, _this3.stPos == _this3.edPos);
                    _this3.PaceOn();
                });
            } else {
                this.movePace = [0, 0];
                this.EnsurePlace();
            }
        }
    }, {
        key: "EnsurePlace",
        value: function EnsurePlace() {
            var targetPos = this.calcPos(this.stPos, this.index);
            this.owner.pos(targetPos[0], targetPos[1]);
        }
    }, {
        key: "GetCurrent",
        value: function GetCurrent() {
            this.current = true;
        }
    }, {
        key: "LoseCurrent",
        value: function LoseCurrent() {
            this.current = false;
            if (this.owner.filters) {
                var filter = this.owner.filters[0];
                filter.reset();
                this.br = 0;
            }
        }
    }]);

    return StandMove;
}(Laya.Script);

exports.default = StandMove;

},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL0xheWFCb3gvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcuanMiLCJzcmMvTWFpbi5qcyIsInNyYy9zY3JpcHQvQ2hlc3NTY2VuZS5qcyIsInNyYy9zY3JpcHQvR2FtZURhdGEuanMiLCJzcmMvc2NyaXB0L2FkZG9uL25hbWVNYXAuanMiLCJzcmMvc2NyaXB0L2NvbXBvbmVudC9Cb2FyZFNldC5qcyIsInNyYy9zY3JpcHQvY29tcG9uZW50L0dyaWRTZXQuanMiLCJzcmMvc2NyaXB0L2NvbXBvbmVudC9yYW5kb21Ub3V6LmpzIiwic3JjL3NjcmlwdC9jb21wb25lbnQvc3RhbmRNb3ZlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7cWpCQ1ZBOzs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7Ozs7OztJQUVxQixVOzs7Ozs7OytCQUNIO0FBQ1Y7QUFDQSxnQkFBSSxNQUFNLEtBQUssVUFBTCxDQUFnQixRQUExQjtBQUNOLGdCQUFJLHNCQUFKLEVBQTJCLG9CQUEzQjtBQUNBLGdCQUFJLDhCQUFKLEVBQW1DLGtCQUFuQztBQUNBLGdCQUFJLGdDQUFKLEVBQXFDLG9CQUFyQztBQUNBLGdCQUFJLDZCQUFKLEVBQWtDLGlCQUFsQztBQUNBLGdCQUFJLCtCQUFKLEVBQW9DLG1CQUFwQztBQUNHOzs7Ozs7a0JBVGdCLFU7O0FBV3JCLFdBQVcsS0FBWCxHQUFtQixJQUFuQjtBQUNBLFdBQVcsTUFBWCxHQUFvQixHQUFwQjtBQUNBLFdBQVcsU0FBWCxHQUFzQixTQUF0QjtBQUNBLFdBQVcsVUFBWCxHQUF3QixZQUF4QjtBQUNBLFdBQVcsTUFBWCxHQUFvQixLQUFwQjtBQUNBLFdBQVcsTUFBWCxHQUFvQixNQUFwQjtBQUNBLFdBQVcsVUFBWCxH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QUFFQSxxQkFBSyxRQUFMLEdBQWdCLENBQUMsS0FBSyxTQUFMLEdBQWlCLElBQWpCLEdBQXdCLFFBQXpCLEVBQW1DLEtBQUssU0FBTCxHQUFpQixJQUFqQixHQUF3QixRQUEzRCxDQUFoQjs7QUFFQSxxQkFBSyxLQUFMLENBQVcsU0FBWCxDQUFxQixRQUFyQixFQUErQixJQUEvQixFQUFxQyxZQUFNO0FBQ3ZDLDJCQUFLLEtBQUwsSUFBYyxPQUFLLEdBQW5CO0FBQ0EsMkJBQUssV0FBTDtBQUNBLDJCQUFLLFdBQUwsQ0FBaUIsT0FBSyxLQUF0QixFQUE0QixPQUFLLEtBQUwsSUFBWSxPQUFLLEtBQTdDO0FBQ0EsMkJBQUssTUFBTDtBQUNILGlCQUxEO0FBTUgsYUFsQkQsTUFrQk87QUFDSCxxQkFBSyxRQUFMLEdBQWdCLENBQUMsQ0FBRCxFQUFJLENBQUosQ0FBaEI7QUFDQSxxQkFBSyxXQUFMO0FBQ0g7QUFDSjs7O3NDQUVZO0FBQ1QsZ0JBQUksWUFBWSxLQUFLLE9BQUwsQ0FBYSxLQUFLLEtBQWxCLEVBQXdCLEtBQUssS0FBN0IsQ0FBaEI7QUFDQSxpQkFBSyxLQUFMLENBQVcsR0FBWCxDQUFlLFVBQVUsQ0FBVixDQUFmLEVBQTZCLFVBQVUsQ0FBVixDQUE3QjtBQUNIOzs7cUNBRVc7QUFDUixpQkFBSyxPQUFMLEdBQWUsSUFBZjtBQUNIOzs7c0NBRVk7QUFDVCxpQkFBSyxPQUFMLEdBQWUsS0FBZjtBQUNBLGdCQUFHLEtBQUssS0FBTCxDQUFXLE9BQWQsRUFBc0I7QUFDbEIsb0JBQUksU0FBUyxLQUFLLEtBQUwsQ0FBVyxPQUFYLENBQW1CLENBQW5CLENBQWI7QUFDQSx1QkFBTyxLQUFQO0FBQ0EscUJBQUssRUFBTCxHQUFVLENBQVY7QUFDSDtBQUNKOzs7O0VBekdrQyxLQUFLLE07O2tCQUF2QixTIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qKlRoaXMgY2xhc3MgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTGF5YUFpcklERSwgcGxlYXNlIGRvIG5vdCBtYWtlIGFueSBtb2RpZmljYXRpb25zLiAqL1xyXG5pbXBvcnQgQ2hlc3NTY2VuZSBmcm9tIFwiLi9zY3JpcHQvQ2hlc3NTY2VuZVwiXG5pbXBvcnQgQm9hcmRTZXQgZnJvbSBcIi4vc2NyaXB0L2NvbXBvbmVudC9Cb2FyZFNldFwiXG5pbXBvcnQgcmFuZG9tVG91eiBmcm9tIFwiLi9zY3JpcHQvY29tcG9uZW50L3JhbmRvbVRvdXpcIlxuaW1wb3J0IEdyaWRTZXQgZnJvbSBcIi4vc2NyaXB0L2NvbXBvbmVudC9HcmlkU2V0XCJcbmltcG9ydCBzdGFuZE1vdmUgZnJvbSBcIi4vc2NyaXB0L2NvbXBvbmVudC9zdGFuZE1vdmVcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbmZpZyB7XHJcbiAgICBzdGF0aWMgaW5pdCgpIHtcclxuICAgICAgICAvL+azqOWGjFNjcmlwdOaIluiAhVJ1bnRpbWXlvJXnlKhcclxuICAgICAgICBsZXQgcmVnID0gTGF5YS5DbGFzc1V0aWxzLnJlZ0NsYXNzO1xyXG5cdFx0cmVnKFwic2NyaXB0L0NoZXNzU2NlbmUuanNcIixDaGVzc1NjZW5lKTtcblx0XHRyZWcoXCJzY3JpcHQvY29tcG9uZW50L0JvYXJkU2V0LmpzXCIsQm9hcmRTZXQpO1xuXHRcdHJlZyhcInNjcmlwdC9jb21wb25lbnQvcmFuZG9tVG91ei5qc1wiLHJhbmRvbVRvdXopO1xuXHRcdHJlZyhcInNjcmlwdC9jb21wb25lbnQvR3JpZFNldC5qc1wiLEdyaWRTZXQpO1xuXHRcdHJlZyhcInNjcmlwdC9jb21wb25lbnQvc3RhbmRNb3ZlLmpzXCIsc3RhbmRNb3ZlKTtcclxuICAgIH1cclxufVxyXG5HYW1lQ29uZmlnLndpZHRoID0gMTI4MDtcclxuR2FtZUNvbmZpZy5oZWlnaHQgPSA2NDA7XHJcbkdhbWVDb25maWcuc2NhbGVNb2RlID1cInNob3dhbGxcIjtcclxuR2FtZUNvbmZpZy5zY3JlZW5Nb2RlID0gXCJob3Jpem9udGFsXCI7XHJcbkdhbWVDb25maWcuYWxpZ25WID0gXCJ0b3BcIjtcclxuR2FtZUNvbmZpZy5hbGlnbkggPSBcImxlZnRcIjtcclxuR2FtZUNvbmZpZy5zdGFydFNjZW5lID0gXCJtYWluLnNjZW5lXCI7XHJcbkdhbWVDb25maWcuc2NlbmVSb290ID0gXCJcIjtcclxuR2FtZUNvbmZpZy5kZWJ1ZyA9IHRydWU7XHJcbkdhbWVDb25maWcuc3RhdCA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyA9IGZhbHNlO1xyXG5HYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uID0gdHJ1ZTtcclxuXHJcbkdhbWVDb25maWcuaW5pdCgpO1xyXG4iLCJpbXBvcnQgR2FtZUNvbmZpZyBmcm9tIFwiLi9HYW1lQ29uZmlnXCI7XHJcbmNsYXNzIE1haW4ge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0Ly/moLnmja5JREXorr7nva7liJ3lp4vljJblvJXmk45cdFx0XHJcblx0XHRpZiAod2luZG93W1wiTGF5YTNEXCJdKSBMYXlhM0QuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCk7XHJcblx0XHRlbHNlIExheWEuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCwgTGF5YVtcIldlYkdMXCJdKTtcclxuXHRcdExheWFbXCJQaHlzaWNzXCJdICYmIExheWFbXCJQaHlzaWNzXCJdLmVuYWJsZSgpO1xyXG5cdFx0TGF5YVtcIkRlYnVnUGFuZWxcIl0gJiYgTGF5YVtcIkRlYnVnUGFuZWxcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhLnN0YWdlLnNjYWxlTW9kZSA9IEdhbWVDb25maWcuc2NhbGVNb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5zY3JlZW5Nb2RlID0gR2FtZUNvbmZpZy5zY3JlZW5Nb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5hbGlnblYgPSBHYW1lQ29uZmlnLmFsaWduVjtcclxuXHRcdExheWEuc3RhZ2UuYWxpZ25IID0gR2FtZUNvbmZpZy5hbGlnbkg7XHJcblx0XHQvL+WFvOWuueW+ruS/oeS4jeaUr+aMgeWKoOi9vXNjZW5l5ZCO57yA5Zy65pmvXHJcblx0XHRMYXlhLlVSTC5leHBvcnRTY2VuZVRvSnNvbiA9IEdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb247XHJcblxyXG5cdFx0Ly/miZPlvIDosIPor5XpnaLmnb/vvIjpgJrov4dJREXorr7nva7osIPor5XmqKHlvI/vvIzmiJbogIV1cmzlnLDlnYDlop7liqBkZWJ1Zz10cnVl5Y+C5pWw77yM5Z2H5Y+v5omT5byA6LCD6K+V6Z2i5p2/77yJXHJcblx0XHRpZiAoR2FtZUNvbmZpZy5kZWJ1ZyB8fCBMYXlhLlV0aWxzLmdldFF1ZXJ5U3RyaW5nKFwiZGVidWdcIikgPT0gXCJ0cnVlXCIpIExheWEuZW5hYmxlRGVidWdQYW5lbCgpO1xyXG5cdFx0aWYgKEdhbWVDb25maWcucGh5c2ljc0RlYnVnICYmIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdKSBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXS5lbmFibGUoKTtcclxuXHRcdGlmIChHYW1lQ29uZmlnLnN0YXQpIExheWEuU3RhdC5zaG93KCk7XHJcblx0XHRMYXlhLmFsZXJ0R2xvYmFsRXJyb3IgPSB0cnVlO1xyXG5cclxuXHRcdC8v5r+A5rS76LWE5rqQ54mI5pys5o6n5Yi277yMdmVyc2lvbi5qc29u55SxSURF5Y+R5biD5Yqf6IO96Ieq5Yqo55Sf5oiQ77yM5aaC5p6c5rKh5pyJ5Lmf5LiN5b2x5ZON5ZCO57ut5rWB56iLXHJcblx0XHRMYXlhLlJlc291cmNlVmVyc2lvbi5lbmFibGUoXCJ2ZXJzaW9uLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uVmVyc2lvbkxvYWRlZCksIExheWEuUmVzb3VyY2VWZXJzaW9uLkZJTEVOQU1FX1ZFUlNJT04pO1xyXG5cdH1cclxuXHJcblx0b25WZXJzaW9uTG9hZGVkKCkge1xyXG5cdFx0Ly/mv4DmtLvlpKflsI/lm77mmKDlsITvvIzliqDovb3lsI/lm77nmoTml7blgJnvvIzlpoLmnpzlj5HnjrDlsI/lm77lnKjlpKflm77lkIjpm4bph4zpnaLvvIzliJnkvJjlhYjliqDovb3lpKflm77lkIjpm4bvvIzogIzkuI3mmK/lsI/lm75cclxuXHRcdExheWEuQXRsYXNJbmZvTWFuYWdlci5lbmFibGUoXCJmaWxlY29uZmlnLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uQ29uZmlnTG9hZGVkKSk7XHJcblx0fVxyXG5cclxuXHRvbkNvbmZpZ0xvYWRlZCgpIHtcclxuXHRcdC8v5Yqg6L29SURF5oyH5a6a55qE5Zy65pmvXHJcblx0XHRHYW1lQ29uZmlnLnN0YXJ0U2NlbmUgJiYgTGF5YS5TY2VuZS5vcGVuKEdhbWVDb25maWcuc3RhcnRTY2VuZSk7XHJcblx0fVxyXG59XHJcbi8v5r+A5rS75ZCv5Yqo57G7XHJcbm5ldyBNYWluKCk7XHJcbiIsImltcG9ydCBHYW1lRGF0YSBmcm9tIFwiLi9HYW1lRGF0YVwiXHJcbmltcG9ydCBCb2FyZFNldCBmcm9tIFwiLi9jb21wb25lbnQvQm9hcmRTZXRcIlxyXG5pbXBvcnQgR3JpZFNldCBmcm9tIFwiLi9jb21wb25lbnQvR3JpZFNldFwiXHJcbmltcG9ydCBSYW5kb21Ub3V6aSBmcm9tIFwiLi9jb21wb25lbnQvcmFuZG9tVG91elwiO1xyXG5pbXBvcnQgU3RhbmRNb3ZlIGZyb20gXCIuL2NvbXBvbmVudC9zdGFuZE1vdmVcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENoZXNzU2NlbmUgZXh0ZW5kcyBMYXlhLlNjZW5lIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuZ21kID0gR2FtZURhdGEuR2V0SW5zdGFuY2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkVuYWJsZSgpIHtcclxuICAgICAgICB0aGlzLmluaXRBbGxQcmVTZXQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0U2NlbmVVSSgpO1xyXG4gICAgICAgIHRoaXMuaW5pdEFsbEdyaWRzKCk7XHJcbiAgICAgICAgdGhpcy5pbml0QWxsQ2hlc3NlcygpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXREZWJ1ZygpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRBbGxQcmVTZXQoKSB7XHJcbiAgICAgICAgdGhpcy5wcmVTZXQgPSB0aGlzLkJvcmFkLmdldENvbXBvbmVudChCb2FyZFNldCk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdFNjZW5lVUkoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGluaXRBbGxHcmlkcygpIHtcclxuICAgICAgICB0aGlzLmdyaWRzID0gW107XHJcblxyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5nbWQuYm9yYWREYXRhcztcclxuICAgICAgICB2YXIgY291bnQgPSBkYXRhLmNvdW50O1xyXG4gICAgICAgIHZhciBwcmVzZXQgPSB0aGlzLnByZVNldC5ncmlkUHJlO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGdyaWRPYmogPSBwcmVzZXQuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHZhciBncmlkID0ge1xyXG4gICAgICAgICAgICAgICAgY29tOiBncmlkT2JqLFxyXG4gICAgICAgICAgICAgICAgSUQ6IGksXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLnJhbmRvbSA/IHRoaXMuZ2V0UmFuZG9tR3JpZChpKSA6IGRhdGFbaV1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmdyaWRzLnB1c2goZ3JpZCk7XHJcbiAgICAgICAgICAgIHRoaXMuQm9hcmRDb250ZW50LmFkZENoaWxkKGdyaWRPYmopO1xyXG5cclxuICAgICAgICAgICAgZ3JpZE9iai5nZXRDb21wb25lbnQoR3JpZFNldCkuU2V0R3JpZERhdGEoZ3JpZC5kYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVmcmVzaENvbnRlbnRTY3JvbGwoKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0QWxsQ2hlc3NlcygpIHtcclxuICAgICAgICB0aGlzLmNoZXNzZXMgPSBbXTtcclxuICAgICAgICB2YXIgcHJlc2V0ID0gdGhpcy5wcmVTZXQuY2hlc3NQcmU7XHJcblxyXG4gICAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5nbWQuZ2FtZUNvbmZpZy5tYXhQbGF5ZXI7aSsrKXtcclxuICAgICAgICAgICAgdmFyIGNoZXNzT2JqID0gcHJlc2V0LmNyZWF0ZSgpO1xyXG4gICAgICAgICAgICB2YXIgbW92ZUNvbSA9IGNoZXNzT2JqLmdldENvbXBvbmVudChTdGFuZE1vdmUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgbW92ZUNvbS5TZXRTdGFuZEluZGV4KGkpO1xyXG4gICAgICAgICAgICBtb3ZlQ29tLlNldENhbGNQb3MoKGluZGV4LGlkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9zID0gX3RoaXMuQ2FsY1BvcyhpbmRleClcclxuICAgICAgICAgICAgICAgIHZhciBvZmZQb3MgPSBbNTAgKyA1MCAqIChpZCUyKSAsIDYwICsgTWF0aC5mbG9vcihpZC8yKSAqIDgwXTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBbcG9zWzBdICsgb2ZmUG9zWzBdLCBwb3NbMV0gKyBvZmZQb3NbMV1dO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5jaGVzc2VzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgaWQ6IGksXHJcbiAgICAgICAgICAgICAgICBjb206IGNoZXNzT2JqLFxyXG4gICAgICAgICAgICAgICAgcG9zSW5kZXg6IDAsXHJcbiAgICAgICAgICAgICAgICBzY29yZTogMCxcclxuICAgICAgICAgICAgICAgIG1vdmU6IG1vdmVDb20sXHJcbiAgICAgICAgICAgICAgICBpc0FJOmk+MFxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgY2hlc3NPYmouek9yZGVyID0gMjA7XHJcblxyXG4gICAgICAgICAgICB0aGlzLkJvYXJkQ29udGVudC5hZGRDaGlsZChjaGVzc09iaik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmN1ckNoZXNzID0gMDtcclxuICAgICAgICB0aGlzLlJlZnJlc2hTY29yZSgpO1xyXG5cclxuICAgICAgICB0aGlzLmdldEN1clBsYXllcigpLm1vdmUuR2V0Q3VycmVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEN1clBsYXllcigpe1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNoZXNzZXNbdGhpcy5jdXJDaGVzc107XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UmFuZG9tR3JpZChfaW5kZXgpIHtcclxuXHJcbiAgICAgICAgdmFyIG1vdmVGbGFnID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogOCk7XHJcbiAgICAgICAgdmFyIHNjb3JlR2V0ID0gMDtcclxuICAgICAgICB2YXIgZGVzYyA9ICcnO1xyXG5cclxuICAgICAgICBpZihfaW5kZXg9PTApe1xyXG4gICAgICAgICAgICBtb3ZlRmxhZyA9IDA7XHJcbiAgICAgICAgICAgIGRlc2MgPSAn6LW354K5JztcclxuICAgICAgICB9ZWxzZSBpZihfaW5kZXggPT0gdGhpcy5nbWQuYm9yYWREYXRhcy5jb3VudCAtIDEpe1xyXG4gICAgICAgICAgICBtb3ZlRmxhZyA9IDA7XHJcbiAgICAgICAgICAgIGRlc2MgPSAn57uI54K5JztcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgaWYgKG1vdmVGbGFnIDwgNikge1xyXG4gICAgICAgICAgICAgICAgc2NvcmVHZXQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA2KSAqIDUwMCAtIDEwMDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoc2NvcmVHZXQ+PTApXHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcmVHZXQgKz0gNTAwO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHNjb3JlR2V0IC89IDI7XHJcbiAgICAgICAgICAgICAgICBtb3ZlRmxhZyA9IDA7XHJcbiAgICAgICAgICAgICAgICBkZXNjICs9IGBTY29yZToke3Njb3JlR2V0fWA7XHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgbW92ZUZsYWcgLT0gNTtcclxuICAgICAgICAgICAgICAgIGRlc2MgKz0gbW92ZUZsYWcgPT0gMSA/ICfliY3ov5snIDogJ+WQjumAgCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciByYW5kUmFuZ2UgPSAobWF4KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY29sb3I6IFtyYW5kUmFuZ2UoMjU1KSwgcmFuZFJhbmdlKDI1NSksIHJhbmRSYW5nZSgyNTUpXSxcclxuICAgICAgICAgICAgdGl0bGU6IGBJbmRleCR7X2luZGV4fWAsXHJcbiAgICAgICAgICAgIG1vdmVUYWc6IG1vdmVGbGFnLFxyXG4gICAgICAgICAgICBzY29yZUdldDogc2NvcmVHZXQsXHJcbiAgICAgICAgICAgIGZ1bmM6IGZ1bmN0aW9uIChwbGF5ZXIpIHt9LFxyXG4gICAgICAgICAgICBpbmRleDogX2luZGV4LFxyXG4gICAgICAgICAgICBkZXNjOmRlc2MsXHJcbiAgICAgICAgICAgIHBvczogdGhpcy5DYWxjUG9zKF9pbmRleClcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgQ2FsY1BvcyhfaW5kZXgpIHtcclxuICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdtZC5ib3JhZERhdGFzLndpZHRoO1xyXG4gICAgICAgIHZhciB4T2ZmID0gKHdpZHRoICsgMSkgKiAyO1xyXG4gICAgICAgIHZhciB5T2ZmID0gd2lkdGggKyAxO1xyXG5cclxuICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoX2luZGV4IC8geU9mZikgKiAyICogMjAyICsgMTA7XHJcbiAgICAgICAgaWYgKChfaW5kZXggKyAxKSAlIHlPZmYgPT0gMCkge1xyXG4gICAgICAgICAgICB5ICs9IDIwMjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB4ID0gMDtcclxuICAgICAgICB2YXIgeGRpciA9IF9pbmRleCAlIHhPZmY7XHJcbiAgICAgICAgaWYgKHhkaXIgPCB3aWR0aCkge1xyXG4gICAgICAgICAgICB4ID0geGRpciAqIDE1MiArIDEwO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoeGRpciA9PSB3aWR0aCkge1xyXG4gICAgICAgICAgICB4ID0geGRpciAqIDE1MiArIDEwIC0gMTUyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoeGRpciA+IHdpZHRoICYmIHhkaXIgPCB4T2ZmIC0gMSkge1xyXG4gICAgICAgICAgICB4ID0gKDIgKiB3aWR0aCAtIHhkaXIpICogMTUyICsgMTA7XHJcbiAgICAgICAgfSBlbHNlIGlmICh4ZGlyID09IHhPZmYgLSAxKSB7XHJcbiAgICAgICAgICAgIHggPSAxMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBbeCwgeV07XHJcbiAgICB9XHJcblxyXG4gICAgcmVmcmVzaENvbnRlbnRTY3JvbGwoKSB7XHJcbiAgICAgICAgdmFyIHdpZHRoID0gdGhpcy5nbWQuYm9yYWREYXRhcy53aWR0aDtcclxuICAgICAgICB2YXIgY291bnQgPSB0aGlzLmdtZC5ib3JhZERhdGFzLmNvdW50O1xyXG4gICAgICAgIHZhciB5T2ZmID0gd2lkdGggKyAxO1xyXG5cclxuICAgICAgICB0aGlzLkJvYXJkQ29udGVudC53aWR0aCA9IHdpZHRoICogMTUyICsgMzA7XHJcbiAgICAgICAgdGhpcy5Cb2FyZENvbnRlbnQuaGVpZ2h0ID0gNjMwO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXREZWJ1ZygpIHtcclxuICAgICAgICB0aGlzLnRlc3Qub24oTGF5YS5FdmVudC5DTElDSywgdGhpcywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRlc3QudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLlNpZ2h0TG9ja09uKHRoaXMuZ2V0Q3VyUGxheWVyKCkpO1xyXG4gICAgICAgICAgICB0aGlzLlJvbGxEaWNlVG9Nb3ZlT24odHJ1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgUm9sbERpY2VUb01vdmVPbihkaXIpe1xyXG4gICAgICAgIHRoaXMudG91ei5nZXRDb21wb25lbnQoUmFuZG9tVG91emkpLkFjdGlvbih0aGlzLCAoc2NvcmUpID0+IHtcclxuICAgICAgICAgICAgdmFyIGN1ckluZGV4ID0gdGhpcy5nZXRDdXJQbGF5ZXIoKS5wb3NJbmRleDtcclxuXHJcbiAgICAgICAgICAgIHZhciBhZkluZGV4ID0gY3VySW5kZXg7XHJcblxyXG4gICAgICAgICAgICBpZihkaXIpe1xyXG4gICAgICAgICAgICAgICAgYWZJbmRleCA9IE1hdGgubWluKHRoaXMuZ21kLmJvcmFkRGF0YXMuY291bnQgLSAxLCBzY29yZSArIGN1ckluZGV4KTtcclxuICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICBhZkluZGV4ID0gTWF0aC5tYXgoMCwgY3VySW5kZXggLSBzY29yZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Q3VyUGxheWVyKCkubW92ZS5Nb3ZlVG9Qb3MoY3VySW5kZXgsIGFmSW5kZXgsIChpbmRleCwgcGFzcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZ2V0Q3VyUGxheWVyKCkucG9zSW5kZXggPSBpbmRleDtcclxuICAgICAgICAgICAgICAgIGlmIChwYXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuVHJpZ2dlckF0R3JpZCh0aGlzLmdldEN1clBsYXllcigpLGluZGV4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIF90aGlzLlNpZ2h0TG9ja09uKF90aGlzLmdldEN1clBsYXllcigpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgVHJpZ2dlckF0R3JpZChwbGF5ZXIsX2luZGV4KXtcclxuICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuZ3JpZHNbX2luZGV4XTtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgZGF0YSA9IGdyaWQuZGF0YTtcclxuXHJcbiAgICAgICAgaWYoZGF0YS5zY29yZUdldCAhPSAwKXtcclxuICAgICAgICAgICAgcGxheWVyLnNjb3JlICs9IGRhdGEuc2NvcmVHZXQ7XHJcbiAgICAgICAgfWVsc2UgaWYoZGF0YS5tb3ZlVGFnID09IDEpe1xyXG4gICAgICAgICAgICBMYXlhLnRpbWVyLm9uY2UoNTAwLHRoaXMsKCk9PntcclxuICAgICAgICAgICAgICAgIHRoaXMuUm9sbERpY2VUb01vdmVPbih0cnVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9ZWxzZSBpZihkYXRhLm1vdmVUYWcgPT0gMil7XHJcbiAgICAgICAgICAgIExheWEudGltZXIub25jZSg1MDAsdGhpcywoKT0+e1xyXG4gICAgICAgICAgICAgICAgdGhpcy5Sb2xsRGljZVRvTW92ZU9uKGZhbHNlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuUmVmcmVzaFNjb3JlKCk7XHJcbiAgICAgICAgdGhpcy5OZXh0UGxheWVyKCk7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgUmVmcmVzaFNjb3JlKCl7XHJcbiAgICAgICAgdGhpcy5TY29yZS50ZXh0ID0gYCR7dGhpcy5nZXRDdXJQbGF5ZXIoKS5zY29yZX1gO1xyXG4gICAgfVxyXG5cclxuICAgIE5leHRQbGF5ZXIoKXtcclxuXHJcbiAgICAgICAgdGhpcy5nZXRDdXJQbGF5ZXIoKS5tb3ZlLkxvc2VDdXJyZW50KCk7XHJcblxyXG4gICAgICAgIHRoaXMuY3VyQ2hlc3MrKztcclxuICAgICAgICB0aGlzLmN1ckNoZXNzJT10aGlzLmdtZC5nYW1lQ29uZmlnLm1heFBsYXllcjtcclxuXHJcbiAgICAgICAgdGhpcy5nZXRDdXJQbGF5ZXIoKS5tb3ZlLkdldEN1cnJlbnQoKTtcclxuXHJcbiAgICAgICAgaWYodGhpcy5nZXRDdXJQbGF5ZXIoKS5pc0FJKXtcclxuICAgICAgICAgICAgTGF5YS50aW1lci5vbmNlKDgwMCx0aGlzLCgpPT57XHJcbiAgICAgICAgICAgICAgICB0aGlzLlNpZ2h0TG9ja09uKHRoaXMuZ2V0Q3VyUGxheWVyKCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5Sb2xsRGljZVRvTW92ZU9uKHRydWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy50ZXN0LnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBTaWdodExvY2tPbihfcGxheWVyKXtcclxuICAgICAgICB2YXIgX2luZGV4ID0gX3BsYXllci5wb3NJbmRleDtcclxuICAgICAgICB2YXIgeW9mZiA9IHRoaXMuQ2FsY1BvcyhfaW5kZXgpWzFdO1xyXG4gICAgICAgIHZhciBjdXJTY3JvbGwgPSB0aGlzLkJvYXJkQ29udGVudC52U2Nyb2xsQmFyLnZhbHVlO1xyXG5cclxuICAgICAgICBpZih5b2ZmIDwgY3VyU2Nyb2xsIHx8IHlvZmYgPiBjdXJTY3JvbGwgKyB0aGlzLkJvYXJkQ29udGVudC5oZWlnaHQgLSAxNTApXHJcbiAgICAgICAgICAgIHRoaXMuQm9hcmRDb250ZW50LnZTY3JvbGxCYXIudmFsdWUgPSB5b2ZmIC0gMTAgLSB0aGlzLkJvYXJkQ29udGVudC5oZWlnaHQvMiArIDEwMDtcclxuICAgIH1cclxufSIsIlxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lRGF0YXtcclxuXHJcbiAgICBzdGF0aWMgR2V0SW5zdGFuY2UoKXtcclxuICAgICAgICBpZighR2FtZURhdGEuaW5zdGFuY2UpXHJcbiAgICAgICAgICAgIEdhbWVEYXRhLmluc3RhbmNlID0gbmV3IEdhbWVEYXRhKCk7XHJcbiAgICAgICAgcmV0dXJuIEdhbWVEYXRhLmluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCl7XHJcbiAgICAgICAgdGhpcy5nYW1lQ29uZmlnID0ge1xyXG4gICAgICAgICAgICBtYXhQbGF5ZXI6NCxcclxuICAgICAgICAgICAgQUlGaXg6dHJ1ZSxcclxuICAgICAgICAgICAgQUlDb3VudDozLFxyXG4gICAgICAgICAgICBjdXJQbGF5ZXI6MVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMuYm9yYWREYXRhcyA9IHtcclxuICAgICAgICAgICAgY291bnQ6MTAwLFxyXG4gICAgICAgICAgICB3aWR0aDo2LFxyXG4gICAgICAgICAgICByYW5kb206dHJ1ZSxcclxuICAgICAgICAgICAgZGF0YXM6W11cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIEdhbWVEYXRhLmluc3RhbmNlID0gdGhpcztcclxuICAgIH1cclxuXHJcbn0iLCJmdW5jdGlvbiBsb2FkX21hcChvYmoscm9vdCxuYW1lTWFwKVxyXG57XHJcbiAgICBmb3IodmFyIG5hbWUgb2YgbmFtZU1hcClcclxuICAgICAgICBvYmpbbmFtZV0gPSByb290LmdldENoaWxkQnlOYW1lKG5hbWUpO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBsb2FkX21hcDsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBCb2FyZFNldCBleHRlbmRzIExheWEuU2NyaXB0e1xyXG5cclxuICAgIC8qKiBAcHJvcCB7bmFtZTpncmlkUHJlLHRpcHM6XCLmo4vnm5jpooTliLZcIix0eXBlOlByZWZhYn0gKi9cclxuICAgIC8qKiBAcHJvcCB7bmFtZTpjaGVzc1ByZSx0aXBzOlwi5qOL5a2Q6aKE5Yi2XCIsdHlwZTpQcmVmYWJ9ICovXHJcblxyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IGxvYWRfbWFwIGZyb20gXCIuLi9hZGRvbi9uYW1lTWFwXCJcclxuICAgIFxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHcmlkU2V0IGV4dGVuZHMgTGF5YS5TY3JpcHR7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLkdyZGlEYXRhID0ge1xyXG4gICAgICAgICAgICBjb2xvcjpbMjU1LDI1NSwyNTVdLFxyXG4gICAgICAgICAgICB0aXRsZTpcIkhlbGxvXCIsXHJcbiAgICAgICAgICAgIGZ1bmM6ZnVuY3Rpb24ocGxheWVyKXt9LFxyXG4gICAgICAgICAgICBtb3ZlVGFnOjAsICAgICAgXHJcbiAgICAgICAgICAgIHNjb3JlR2V0OjAsXHJcbiAgICAgICAgICAgIGRlc2M6XCJcIixcclxuICAgICAgICAgICAgaW5kZXg6MCxcclxuICAgICAgICAgICAgcG9zOlswLDBdXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29sb3JEaXJ0eSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRW5hYmxlKCl7XHJcbiAgICAgICAgbG9hZF9tYXAodGhpcyx0aGlzLm93bmVyLmNvbnRlbnQsW1widGl0bGVcIixcImJnXCIsXCJkZXNjXCJdKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2hHcmlkKCk7XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBvblVwZGF0ZSgpe1xyXG4gICAgICAgIGlmKHRoaXMuY29sb3JEaXJ0eSAmJiB0aGlzLmJnLmZpbHRlcnMpe1xyXG4gICAgICAgICAgICB0aGlzLmNvbG9yRmlsdGVyID0gdGhpcy5iZy5maWx0ZXJzWzBdO1xyXG4gICAgICAgICAgICB2YXIgY29sb3IgPSB0aGlzLkdyZGlEYXRhLmNvbG9yO1xyXG4gICAgICAgICAgICB0aGlzLmNvbG9yRmlsdGVyLmNvbG9yKGNvbG9yWzBdLGNvbG9yWzFdLGNvbG9yWzJdKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgU2V0R3JpZERhdGEoX2RhdGEpe1xyXG4gICAgICAgIHRoaXMuR3JkaURhdGEgPSBfZGF0YTtcclxuICAgICAgICBpZih0aGlzLnNob3dpbmcpe1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hHcmlkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuY29sb3JEaXJ0eSA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcmVmcmVzaEdyaWQoKXtcclxuICAgICAgICB0aGlzLm93bmVyLnBvcyh0aGlzLkdyZGlEYXRhLnBvc1swXSx0aGlzLkdyZGlEYXRhLnBvc1sxXSk7XHJcbiAgICAgICAgdGhpcy50aXRsZS50ZXh0ID0gdGhpcy5HcmRpRGF0YS50aXRsZTtcclxuICAgICAgICB0aGlzLmRlc2MudGV4dCA9IHRoaXMuR3JkaURhdGEuZGVzYztcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFJhbmRvbVRvdXppIGV4dGVuZHMgTGF5YS5TY3JpcHR7XHJcblxyXG4gICAgLyoqIEBwcm9wIHtuYW1lOnJvbGxHYXAsdGlwczpcIumqsOWtkOaXi+i9rOWRqOacn1wiLHR5cGU6SW50fSAqL1xyXG4gICAgLyoqIEBwcm9wIHtuYW1lOnJvbGxUaW1lLHRpcHM6XCLpqrDlrZDml4vovazml7bpl7RcIix0eXBlOkludH0gKi9cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcigpe1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25FbmFibGUoKXtcclxuICAgICAgICB0aGlzLnJvbGxpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm51bWJlciA9IDE7XHJcblxyXG4gICAgICAgIHRoaXMub3duZXIudGV4dHVyZSA9IGBpbWFnZS8ke3RoaXMubnVtYmVyfS5wbmdgO1xyXG4gICAgICAgIFxyXG4gICAgICAgIExheWEudGltZXIuZnJhbWVMb29wKHRoaXMucm9sbEdhcCx0aGlzLCgpPT57XHJcbiAgICAgICAgICAgIGlmKHRoaXMucm9sbGluZyl7XHJcbiAgICAgICAgICAgICAgICB0aGlzLlJhbmRvbU9uY2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIEFjdGlvbihjYWxsZXIscmVzRnVuYyl7XHJcbiAgICAgICAgdGhpcy5yb2xsaW5nID0gdHJ1ZTtcclxuICAgICAgICBMYXlhLnRpbWVyLm9uY2UodGhpcy5yb2xsVGltZSx0aGlzLCgpPT57XHJcbiAgICAgICAgICAgIHRoaXMucm9sbGluZyA9ZmFsc2U7XHJcbiAgICAgICAgICAgIHJlc0Z1bmMuY2FsbChjYWxsZXIsdGhpcy5udW1iZXIpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgUmFuZG9tT25jZSgpe1xyXG4gICAgICAgIHRoaXMubnVtYmVyID0gdGhpcy5udW1iZXIgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA1KTtcclxuICAgICAgICB0aGlzLm51bWJlciAlPSA2O1xyXG4gICAgICAgIHRoaXMubnVtYmVyICs9IDE7XHJcblxyXG4gICAgICAgIHRoaXMub3duZXIudGV4dHVyZSA9IGBpbWFnZS8ke3RoaXMubnVtYmVyfS5wbmdgO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RhbmRNb3ZlIGV4dGVuZHMgTGF5YS5TY3JpcHQge1xyXG5cclxuICAgIC8qKiBAcHJvcCB7bmFtZTptb3ZlU3BlZWQsdGlwczpcIuenu+WKqOmAn+W6plwiLHR5cGU6SW50fSAqL1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5jYWxjUG9zID0gKF9pbmRleCxfaWQpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIFswLCAwXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMudHJpZ2dlckZ1bmMgPSAoaW5kZXgscGFzcykgPT4ge307XHJcbiAgICAgICAgdGhpcy5zdFBvcyA9IDA7XHJcbiAgICAgICAgdGhpcy5lZFBvcyA9IDA7XHJcbiAgICAgICAgdGhpcy50YXJnZXRQb3MgPSBbMCwgMF07XHJcbiAgICAgICAgdGhpcy5tb3ZlUGFjZSA9IFswLCAwXTtcclxuICAgICAgICB0aGlzLmRpciA9IDE7XHJcblxyXG4gICAgICAgIHRoaXMuaW5kZXggPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmJyID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBvbkVuYWJsZSgpIHtcclxuICAgICAgICBMYXlhLnRpbWVyLmZyYW1lTG9vcCgxLCB0aGlzLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1vdmVQYWNlWzBdICE9IDAgfHwgdGhpcy5tb3ZlUGFjZVsxXSAhPSAwKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5vd25lci5wb3ModGhpcy5vd25lci54ICsgdGhpcy5tb3ZlUGFjZVswXSwgdGhpcy5vd25lci55ICsgdGhpcy5tb3ZlUGFjZVsxXSlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgTGF5YS50aW1lci5sb29wKDEwMCx0aGlzLCgpPT57XHJcbiAgICAgICAgICAgIGlmKHRoaXMuY3VycmVudCl7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLm93bmVyLmZpbHRlcnMpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWx0ZXIgPSB0aGlzLm93bmVyLmZpbHRlcnNbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBiciA9IE1hdGguc2luKHRoaXMuYnIpICogMTAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYnIgKz0gMC40O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjYnIgPSBNYXRoLnNpbih0aGlzLmJyKSAqIDEwMDtcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXIuYWRqdXN0QnJpZ2h0bmVzcyhjYnIgLSBwYnIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgU2V0Q2FsY1BvcyhmdW5jKSB7XHJcbiAgICAgICAgdGhpcy5jYWxjUG9zID0gZnVuYztcclxuICAgICAgICB0aGlzLkVuc3VyZVBsYWNlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgU2V0U3RhbmRJbmRleChpZCl7XHJcbiAgICAgICAgdGhpcy5pbmRleCA9IGlkO1xyXG4gICAgICAgIHRoaXMub3duZXIudGV4dHVyZSA9IGBpbWFnZS90JHtpZH0ucG5nYDtcclxuICAgIH1cclxuXHJcbiAgICBNb3ZlVG9Qb3Moc3RpbmRleCwgZWRpbmRleCwgcmVGdW5jKSB7XHJcbiAgICAgICAgdGhpcy5zdFBvcyA9IHN0aW5kZXg7XHJcbiAgICAgICAgdGhpcy5lZFBvcyA9IGVkaW5kZXg7XHJcbiAgICAgICAgdGhpcy50cmlnZ2VyRnVuYyA9IHJlRnVuYztcclxuXHJcbiAgICAgICAgdGhpcy5kaXIgPSBlZGluZGV4ID4gc3RpbmRleCA/IDEgOiAtMTtcclxuXHJcbiAgICAgICAgdGhpcy5FbnN1cmVQbGFjZSgpO1xyXG5cclxuICAgICAgICB0aGlzLlBhY2VPbigpO1xyXG4gICAgfVxyXG5cclxuICAgIFBhY2VPbigpIHtcclxuICAgICAgICB2YXIgY3VyUG9zID0gW3RoaXMub3duZXIueCwgdGhpcy5vd25lci55XTtcclxuICAgICAgICBpZiAodGhpcy5lZFBvcyAhPSB0aGlzLnN0UG9zKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRQb3MgPSB0aGlzLmNhbGNQb3ModGhpcy5zdFBvcyArIHRoaXMuZGlyLHRoaXMuaW5kZXgpO1xyXG4gICAgICAgICAgICB0aGlzLnRhcmdldFBvcyA9IHRhcmdldFBvcztcclxuXHJcbiAgICAgICAgICAgIHZhciB4b2ZmID0gdGhpcy50YXJnZXRQb3NbMF0gLSBjdXJQb3NbMF07XHJcbiAgICAgICAgICAgIHZhciB5b2ZmID0gdGhpcy50YXJnZXRQb3NbMV0gLSBjdXJQb3NbMV07XHJcblxyXG4gICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBNYXRoLnNxcnQoeG9mZiAqIHhvZmYgKyB5b2ZmICogeW9mZik7XHJcbiAgICAgICAgICAgIHZhciB0aW1lQ29zdCA9IGRpc3RhbmNlIC8gdGhpcy5tb3ZlU3BlZWQ7XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1vdmVQYWNlID0gW3RoaXMubW92ZVNwZWVkICogeG9mZiAvIGRpc3RhbmNlLCB0aGlzLm1vdmVTcGVlZCAqIHlvZmYgLyBkaXN0YW5jZV07XHJcblxyXG4gICAgICAgICAgICBMYXlhLnRpbWVyLmZyYW1lT25jZSh0aW1lQ29zdCwgdGhpcywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdFBvcyArPSB0aGlzLmRpcjtcclxuICAgICAgICAgICAgICAgIHRoaXMuRW5zdXJlUGxhY2UoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlckZ1bmModGhpcy5zdFBvcyx0aGlzLnN0UG9zPT10aGlzLmVkUG9zKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuUGFjZU9uKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubW92ZVBhY2UgPSBbMCwgMF07XHJcbiAgICAgICAgICAgIHRoaXMuRW5zdXJlUGxhY2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgRW5zdXJlUGxhY2UoKXtcclxuICAgICAgICB2YXIgdGFyZ2V0UG9zID0gdGhpcy5jYWxjUG9zKHRoaXMuc3RQb3MsdGhpcy5pbmRleCk7XHJcbiAgICAgICAgdGhpcy5vd25lci5wb3ModGFyZ2V0UG9zWzBdLCB0YXJnZXRQb3NbMV0pXHJcbiAgICB9XHJcblxyXG4gICAgR2V0Q3VycmVudCgpe1xyXG4gICAgICAgIHRoaXMuY3VycmVudCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgTG9zZUN1cnJlbnQoKXtcclxuICAgICAgICB0aGlzLmN1cnJlbnQgPSBmYWxzZTtcclxuICAgICAgICBpZih0aGlzLm93bmVyLmZpbHRlcnMpe1xyXG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gdGhpcy5vd25lci5maWx0ZXJzWzBdO1xyXG4gICAgICAgICAgICBmaWx0ZXIucmVzZXQoKTtcclxuICAgICAgICAgICAgdGhpcy5iciA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59Il19
